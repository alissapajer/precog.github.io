var currentLocation=window.location.pathname;var currentGenLocation=window.location.pathname.substr(0,10);$(document).ready(function(){var o=sessionStorage.getItem("PrecogAccount_Login");if(o){$("#login-link").html("Log Out").attr("href","#").addClass("log-out-link");$("<li><a id='my-account-link' href='/account/'>Account</a></li>").prependTo("#header-mini-menu ul");var h=sessionStorage.getItem("PrecogAccount_Email");var p=sessionStorage.getItem("PrecogAccount_Name");var d=sessionStorage.getItem("PrecogAccount_Company");var e=sessionStorage.getItem("PrecogAccount_ID");var f=sessionStorage.getItem("PrecogAccount_ApiKey");var m={name:p,company:d,account_id:e};var i=new Scribe({tracker:function(t){var s=t.path;var r=t.value;if(typeof console!=="undefined"){console.log(s);console.log(r);t.success&&setTimeout(t.success,0)}else{t.failure&&setTimeout(t.failure,0)}}});i.identify(h,m)}$(".log-out-link").click(function(){$(this).html("Login").attr("href","/account/login/").removeClass("log-out-link");sessionStorage.removeItem("PrecogAccount_Email");sessionStorage.removeItem("PrecogAccount_Name");sessionStorage.removeItem("PrecogAccount_Company");sessionStorage.removeItem("PrecogAccount_ID");sessionStorage.removeItem("PrecogAccount_ApiKey");sessionStorage.removeItem("PrecogAccount_AnalyticsService");sessionStorage.removeItem("PrecogAccount_BasePath");sessionStorage.removeItem("PrecogAccount_Login");window.location="https://www.precog.com";$(this).html("Login").attr("href","/account/login/").removeClass("log-out-link")});if(currentLocation=="/for-developers/"){$("#hiw-menu ul li").click(function(){var r=$(this).index();var t=268*r;var s=(118+t);$(".arrow-up").animate({left:s},200)})}$("#pricing-options-menu li").click(function(){$("#pricing-options-menu li").removeClass("active");$(this).addClass("active");var r=$(this).index();if(r==0){$(".pricing-panel").hide();$("#pricing-options-cloud").show()}else{if(r==1){$(".pricing-panel").hide();$("#pricing-options-hardware").show()}else{if(r==2){$(".pricing-panel").hide();$("#pricing-options-appliance").show()}}}});if(currentLocation=="/account/login/"||currentLocation=="/for-developers/"){if(currentLocation=="/account/login/"){var o=sessionStorage.getItem("PrecogAccount_Login");if(o){window.location="/account/"}}$("#login-email").keyup(function(){var r=$(this).val();$("#user-email").val(r)});$("#login-password").keyup(function(){var r=$(this).val();$("#new-password").val(r);$("#new-password-confirm").val(r)});function c(u,v,s){var t=["https://nebula.precog.com/","https://beta.precog.com/"];var r=0;function w(){if(r<t.length){var y=t[r];r=r+1;var x=v(y);Precog.findAccount(u,x,function(A,z){w()},{analyticsService:y})}else{s()}}w()}$("#precog-form-login").submit(function(t){$("#form-error").remove();var s=$("#login-email").val();var r=$("#login-password").val();$.getScript("/js/precog.js",function(){c(s,function(u){return function(v){Precog.describeAccount(s,r,v,function(w){sessionStorage.setItem("PrecogAccount_Email",s);sessionStorage.setItem("PrecogAccount_ApiKey",w.apiKey);sessionStorage.setItem("PrecogAccount_AnalyticsService",u);sessionStorage.setItem("PrecogAccount_BasePath",w.rootPath);sessionStorage.setItem("PrecogAccount_Login","Logged In");sessionStorage.setItem("PrecogAccount_ID",v);window.location="/account/"},function(){$("#precog-form-login").append("<div id='form-error'><p class='error-font'>The password you entered is incorrect. Please retype your password and try again.</p></div>").find("#form-error").delay(2000).fadeOut(500)},{analyticsService:u})}},function(){$("#precog-form-login").append("<div id='form-error'><p class='error-font'>We were unable to find your account, please double check your enter email address.</p></div>").find("#form-error").delay(2000).fadeOut(500)})});t.preventDefault();return false});$("#precog-form-create-account").submit(function(x){$("#form-error").remove();var u=$("#user-email").val();var w=$("#login-name").val();var v=$("#login-company").val();var r=$("#create-title").val();var t=$("#new-password").val();var s=$("#new-password-confirm").val();if(t==s){if(w.length<4){$("#precog-form-create-account").append("<div id='form-error'><p class='error-font'>Your name must be at least 4 characters. Please re-enter your name.</p></div>").find("#form-error").delay(2000).fadeOut(500)}else{if(v.length<3){$("#precog-form-create-account").append("<div id='form-error'><p class='error-font'>Your company must be at least 4 characters. Please re-enter your company.</p></div>").find("#form-error").delay(2000).fadeOut(500)}else{if(r==""){$("#precog-form-create-account").append("<div id='form-error'><p class='error-font'>The title field is empty. Please re-enter your title.</p></div>").find("#form-error").delay(2000).fadeOut(500)}else{if(t.length<6){$("#precog-form-create-account").append("<div id='form-error'><p class='error-font'>Your password must be at least 6 characters. Please re-enter your password.</p></div>").find("#form-error").delay(2000).fadeOut(500)}else{$.getScript("/js/precog.js",function(){c(u,function(y){return function(z){$("#precog-form-create-account").append("<div id='form-error'><p class='error-font'>We found a previous account under your e-mail address. Please attempt to login or reset your password.</p></div>").find("#form-error").delay(2000).fadeOut(500)}},function(){Precog.$.Config.analyticsService="https://beta.precog.com/";Precog.createAccount(u,t,function(z){var y=z;Precog.describeAccount(u,t,y.accountId,function(E){var A=E;sessionStorage.setItem("PrecogAccount_Email",u);sessionStorage.setItem("PrecogAccount_Name",w);sessionStorage.setItem("PrecogAccount_Company",v);sessionStorage.setItem("PrecogAccount_ID",y.accountId);sessionStorage.setItem("PrecogAccount_ApiKey",A.apiKey);sessionStorage.setItem("PrecogAccount_AnalyticsService",Precog.$.Config.analyticsService);sessionStorage.setItem("PrecogAccount_BasePath",A.rootPath);sessionStorage.setItem("PrecogAccount_Login","Logged In");var D=w.split(" ").slice(0,-1).join(" ");var B=w.split(" ").slice(-1).join(" ");var C=JSON.stringify([{email:u,firstName:D,lastName:B,business:v}]);var F="https://www.precog.com/nodejs/account/login";$.ajax({type:"POST",url:F,dataType:"json",contentType:"application/json",processData:false,data:C,success:function(G){window.location="/account/"}})})},function(y){},{profile:{name:w,title:r,company:v}})})})}}}}}else{$("#precog-form-create-account").append("<div id='form-error'><p class='error-font'>The passwords you have entered do not match. Please check your entry and try again.</p></div>").find("#form-error").delay(2000).fadeOut(500)}x.preventDefault();return false});$("#reset-password").click(function(s){s.preventDefault();var r=$("#login-email").val();if(r){$.getScript("/js/precog.js",function(){Precog.$.Config.analyticsService="https://beta.precog.com/";Precog.requestResetPassword(r,function(){$("#precog-form-login").append("<div id='form-success'><p class='success-font'>A reset link has been sent to your e-mail.</p></div>").find("#form-success").delay(2000).fadeOut(500)},function(){$("#precog-form-login").append("<div id='form-error'><p class='error-font'>The email address you have entered is not valid. Please try again.</p></div>").find("#form-error").delay(2000).fadeOut(500)})})}else{$("#precog-form-login").append("<div id='form-error'><p class='error-font'>Please enter an email address.</p></div>").find("#form-error").delay(2000).fadeOut(500)}})}if(currentLocation=="/account/"){var h=sessionStorage.getItem("PrecogAccount_Email");var p=sessionStorage.getItem("PrecogAccount_Name");var d=sessionStorage.getItem("PrecogAccount_Company");var e=sessionStorage.getItem("PrecogAccount_ID");var f=sessionStorage.getItem("PrecogAccount_ApiKey");var b=sessionStorage.getItem("PrecogAccount_AnalyticsService");var q=sessionStorage.getItem("PrecogAccount_BasePath");var o=sessionStorage.getItem("PrecogAccount_Login");if(o){$("#account-email h3").html(h);$("#account-name h3").html(p);$("#account-company h3").html(d);$("#account-apikey").html(f);$("#account-analyticsservice").html(b);$("#account-basepath").html(q);$("#account-id").html(e);var g=b.substring(0,b.length-1);$.getScript("/js/precog.min.js",function(){var s=new Precog.api({apiKey:f,analyticsService:g});$("#form-path").val(q);var r=$("#current-api-keys");s.listApiKeys().then(function(z){for(var A=0;A<z.length;A++){var B=$("<dl></dl>").appendTo(r);var y=z[A];var H=y.grants[0].permissions[0].path;$("<dt>"+y.name+"</dt><dd>"+y.description+"</dd><dd>"+y.apiKey+"</dd><dd>"+H+"</dd><a class='delete-key' href='#'>Delete Key</a>").appendTo(B);var D=$("<ul class='grants'></ul>").appendTo($("<dd></dd>").appendTo(B));var w=y.grants;for(var x=0;x<w.length;x++){var F=w[x];var v=$("<li><ul class='permissions'></ul></li>").appendTo(D).find(".permissions");var G=w[x].permissions;for(var u=0;u<G.length;u++){var C=G[u];var E=C.accessType;$("<li>"+E+"</li>").appendTo(v)}}}var t=r.html();if(t==""){$("#current-api-keys").append("<dl class='no-api-keys-exist'><dd>No API Keys exist.</dd></dl>")}});$("#current-api-keys").on("click","a",function(v){v.preventDefault();var u=$(this).parent().find("dd:nth-child(3)").html();function t(){var w=confirm("Are you sure you want to delete this API Key?");if(w==true){s.deleteApiKey(u);location.reload()}else{}}t()});$("#precog-create-apikey").submit(function(x){var w=$("#form-name").val();var v=$("#form-description").val();var z=$("#form-path").val();var y=e;if(w.length<1||v.length<3||z.length<3){$(".precog-account-form-full").append("<div id='form-error'><p class='error-font'>Please check entry fields. Each field must contain a value.</p></div>").find("#form-error").delay(2000).fadeOut(500)}else{var u=new Array();$("input:checked").each(function(){grantType=$(this).attr("value");u.push({accessType:grantType,path:z,ownerAccountIds:[y]})});if(u.length<1){$(".precog-account-form-full").append("<div id='form-error'><p class='error-font'>Please select at least one grant to be associated with this API Key</p></div>").find("#form-error").delay(2000).fadeOut(500)}else{var t={name:w,description:v,grants:[{name:"Grant For-"+w,description:"Grant For-"+v,permissions:u}]};s.createApiKey(t).then(function(F){var G=$("<dl></dl>").appendTo(r);var E=F;var M=E.grants[0].permissions[0].path;$("<dt>"+E.name+"</dt><dd>"+E.description+"</dd><dd>"+E.apiKey+"</dd><dd>"+M+"</dd><a class='delete-key' href='#'>Delete Key</a>").appendTo(G);var I=$("<ul class='grants'></ul>").appendTo($("<dd></dd>").appendTo(G));var C=E.grants;for(var D=0;D<C.length;D++){var K=C[D];var B=$("<li><ul class='permissions'></ul></li>").appendTo(I).find(".permissions");var L=C[D].permissions;for(var A=0;A<L.length;A++){var H=L[A];var J=H.accessType;$("<li>"+J+"</li>").appendTo(B)}}$("#current-api-keys .no-api-keys-exist").remove()},function(A){})}}x.preventDefault();return false})})}else{window.location="/account/login/"}var a=("https://labcoat.precog.com/?apiKey="+f+"&basePath="+q+"&analyticsService="+b);$(".product-link-labcoat").attr("href",a)}if(currentLocation=="/account/reset-password-complete/"){function n(r){var u=window.location.search.substring(1);var t=u.split("&");for(var s=0;s<t.length;s++){var v=t[s].split("=");if(v[0]==r){return v[1]}}}var l=n("service");var k=n("accountId");var j=n("token");$("#precog-form-reset-complete").submit(function(u){var w=$("#new-password").val();var s=$("#new-password-confirm").val();if(w==s){var t="https://"+l+"/accounts/v1/accounts/"+k+"/password/reset/"+j;var r={password:w};function v(){window.location="/account/login/"}$.ajax({type:"POST",url:t,processData:false,contentType:"application/json",data:JSON.stringify(r),success:v,dataType:"text"})}else{$(".precog-account-form").append("<div id='form-error'><p class='error-font'>The passwords you have entered do not match. Please check your entry and try again.</p></div>").find("#form-error").delay(2000).fadeOut(500)}u.preventDefault();return false})}$(".pop-up-form").click(function(r){r.preventDefault();$("#pop-up-form").animate({opacity:1,right:"20px"},500)});$(".icon-close-frame").click(function(){$("#pop-up-form").animate({opacity:0,right:"-400px"},500)});if(currentLocation=="/solutions/white-label-reporting/"||currentLocation=="/solutions/social-media-analytics/"||currentLocation=="/solutions/web-analytics/"){$("#section-body h2").each(function(){var s=$(this).html();var r=$(this).html().replace(" ","-");$(this).attr("id",r);$("#body-links").append("<a href='#"+r+"'>"+s+"</a>")})}$("#newsletter-signup-form tr:last-child td:last-child input").addClass("small-button red-background");$("#hiw-menu li").click(function(){var s=$(this).html().split(" ");var r="#howitworks-panel #"+(s[2].toLowerCase());$("#howitworks-panel .panel").hide();$(r).show();$(".panel-content").hide().removeClass("active-content");$(r+" .panel-content:first-child").show()});$("#howitworks-panel .panel .first li").click(function(){var r=$(this).attr("class");$(".panel-content").hide().removeClass("active-content");$(this).parent(".first").siblings("."+r+"-content").show()});$("#howitworks-panel .panel .first-alt li").click(function(){var r=$(this).attr("class");$(".panel-content").hide().removeClass("active-content");$(this).parent(".first-alt").siblings("."+r+"-content").show()});$("#simple-code-box .first li").click(function(){var r=$(this).attr("class");$(".code-panel").hide().removeClass("active-content");$("#"+r+"-code").show()})});