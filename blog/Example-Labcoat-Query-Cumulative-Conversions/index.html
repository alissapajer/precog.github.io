<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Example Labcoat Query- Cumulative Conversions - Precog
    </title>
    <link rel="stylesheet" href="../../css/default.css">
    <link rel="stylesheet" href="../../css/unique.css">
    <link rel="stylesheet" href="../../css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Questrial%7CAbel%7CMontserrat:400,700%7CCinzel:400,700,900" rel="stylesheet" type="text/css">
    <link rel="icon" type="image/png" href="../../images/favicon.png">
    <link rel="alternate" href="../../feed.xml.rss" type="application/rss+xml" title="Precog Big Data Analytics">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script>
    <script type="text/javascript" src="../../js/default.js"></script>
    <script type="text/javascript" src="../../js/unique.js"></script>
    <script type="text/javascript" src="../../js/scribe-console.js"></script>
    <script type="text/javascript" src="../../js/scribe-analytics.js"></script>
    <script type="text/javascript">new Scribe(new ScribeConsoleTracker());</script>
    <script type="text/javascript">
      var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-33659709-1']);
        _gaq.push(['_trackPageview']);
        (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
        
    </script>
  </head>
  <body>
    <header>
      <div class="holder">
        <div id="header-logo"><a href="../../index.html"><img src="../../images/logo-precog.png" alt="Precog"></a></div>
        <div id="header-mini-menu">
          <ul class="menu">
            <li><a id="login-link" href="../../about/contact-us/index.html">Login</a></li>
            <li><a href="../index.html">Blog</a></li>
            <li><a href="mailto:support@precog.com">Support</a></li>
            <li><a href="../../about/contact-us/index.html">Contact</a></li>
          </ul>
        </div>
      </div>
    </header>
    <div id="section-body">
      <div class="holder">
        <div class="two-columns">
          <h1 class="page-title">Example Labcoat Query- Cumulative Conversions</h1>
          <page class="post"></page>
          <section class="content"><p>We want to make the transition to Precog as easy as possible for our customers and so our support team has provided some initial queries to help get started. These queries make it extremely fast to get an application up and running and gives customers example queries that they can modify moving forward. Let&apos;s examine an example query, which includes data from the demo version of Labcoat.</p>
<p>In <a href="http://quirrel-lang.org/">Quirrel</a>, it&apos;s easy to do an aggregation by some time period such as day, week or month.  But sometimes we want this aggregation to include not just the results of that week, but the cumulative results of all prior weeks.  Below is a screenshot from Labcoat displaying cumulative conversions.</p>
<p><img alt="" src="https://lh3.googleusercontent.com/lvSms2-XzlHTKGlckNnQFg0wxO_6EZH6ZxOCRRIQffYKKUzFUihKNApnYwl6olgXvKUoU7ln5SvafB_7nqSSO1bEHuGvQeU3AfZ0PPOnOKpKD0rkWpc" width="709" height="178" /></p>
<p>Let&apos;s walk through the Quirrel needed to produce this result.  First, import the standard library time module so that we can use the weekOfYear function. Then, augment the initial data with a variable called week by using the with command.</p>
<p>Finally, write a solve statement with an explicit constraint.  Explicit constraints for solve statements are declared in the first line of a solve after an &quot;=&quot; equals sign.  This differs from many solve statements that have implicit constraints from where clauses within the body of the solve.  Constraints determine where the values for a tic variable (&apos;week in this case) come from.  So in the example below, the body of the solve statement will be computed for each value of conversions&apos;.week. Explicit constraints are needed for a cumulative query because the inequality needed in the body of the solve statement prevents the where clause from serving as an implicit constraint.</p>
<pre>import std::time::*

conversions := //conversions
conversions&apos; := conversions with { week: weekOfYear(conversions.timeStamp) }

solve &apos;week = conversions&apos;.week
{
week: &apos;week,
cumulativeConversions: count(conversions&apos;.week where conversions&apos;.week &lt;= &apos;week)
}</pre>
<p>You can <a href="https://labcoat.precog.com/?q=import+std::time::%0A%0Aconversions+:=+//conversions%0Aconversions'+:=+conversions+with+%7B+week:+weekOfYear(conversions.%0AtimeStamp)+%7D%0A%0Asolve+'week+=+conversions'.week%0A+%7B%0A+week:+'week,%0A+cumulativeConversions:+count(conversions'.week+where+conversions'.week+%3C=+'week)%0A+%7D">try this query</a> in Labcoat for yourself.</p>
<p>If you need help with a query, just <a href="http://support.precog.com/">let us know</a> and we&apos;ll be happy to help!</p></section>
        </div>
        <div class="two-columns-end">
          <div id="disqus_thread">
            <script type="text/javascript">
              /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
              var disqus_shortname = 'precog'; // required: replace example with your forum shortname
              /* * * DON'T EDIT BELOW THIS LINE * * */
              (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
              })();
            </script>
            <noscript>Please enable JavaScript to view the<a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><a href="http://disqus.com" class="dsq-brlink">comments powered by<span class="logo-disqus">Disqus</span></a>
          </div>
        </div>
        <div class="clear-left"></div>
      </div>
    </div>
    <footer>
      <div class="holder">
        <div id="footer-menu">
          <ul class="menu">
            <li><a href="../../about/contact-us/index.html">About</a>
              <ul>
                <li><a href="../../about/contact-us/index.html">Overview</a></li>
                <li><a href="../../about/contact-us/index.html">Contact</a></li>
                <li><a href="../index.html">Blog</a></li>
              </ul>
            </li>
          </ul>
          <ul class="menu">
            <li><a href="../../for-developers/index.html">For Developers</a>
              <ul>
                <li><a href="../../for-developers/index.html">Overview</a></li>
                <li><a href="../../developers/getting-started/overview/index.html" target="_blank">Dev Center</a></li>
                <li><a href="http://support.precog.com">Support</a></li>
              </ul>
            </li>
          </ul>
          <ul class="menu">
            <li><a href="../../for-businesses/index.html">For Businesses</a>
              <ul>
                <li><a href="../../for-businesses/index.html">Overview</a></li>
                <li><a href="../../solutions/white-label-reporting/index.html">White Label Reporting</a></li>
                <li><a href="../../solutions/social-media-analytics/index.html">Social Media Analytics</a></li>
                <li><a href="../../solutions/web-analytics/index.html">Web Analytics</a></li>
              </ul>
            </li>
          </ul>
        </div>
        <div id="footer-content">
          <div id="copyrights"><a href="../../legal/index.html">privacy and terms of use</a>
            <p>Copyright @ 2012-2013 ReportGrid, Inc. All Rights Reserved</p>
          </div>
        </div>
      </div>
    </footer>
  </body>
</html>